# More inspirations
# https://www.cyberciti.biz/tips/bash-aliases-mac-centos-linux-unix.html
# https://drasite.com/blog/Pimp%20my%20terminal#patched-fonts
# https://gitlab.com/dwt1/dotfiles/-/blob/master/.zshrc
# https://github.com/ChrisTitusTech/mybash/blob/main/.bashrc

################################################################################
# Funcions
################################################################################

command_exists() {
    command -v "$1" >/dev/null 2>&1
}

# Source: https://ostechnix.com/a-bash-function-to-extract-file-archives-of-various-types/
function extract() {
    if [ -f $1 ] ; then
        case $1 in
            *.tar.bz2)   tar xjf $1     ;;
            *.tar.gz)    tar xzf $1     ;;
            *.bz2)       bunzip2 $1     ;;
            *.rar)       rar x $1       ;;
            *.gz)        gunzip $1      ;;
            *.tar)       tar xf $1      ;;
            *.tbz2)      tar xjf $1     ;;
            *.tgz)       tar xzf $1     ;;
            *.zip)       unzip $1       ;;
            *.Z)         uncompress $1  ;;
            *.7z)        7z x $1    ;;
            *)           echo "'$1' cannot be extracted via extract()" ;;
        esac
    else
        echo "'$1' is not a valid file"
    fi
}

# Source: http://tldp.org/HOWTO/Bash-Prompt-HOWTO/x329.html
function colortest() {
    T='gYw'
    echo -e "\n                 40m     41m     42m     43m     44m     45m     46m     47m";
    for FGs in '    m' '   1m' '  30m' '1;30m' '  31m' '1;31m' '  32m' \
            '1;32m' '  33m' '1;33m' '  34m' '1;34m' '  35m' '1;35m' \
            '  36m' '1;36m' '  37m' '1;37m';
    do FG=${FGs// /}
        echo -en " $FGs \033[$FG  $T  "
        for BG in 40m 41m 42m 43m 44m 45m 46m 47m;
            do echo -en "$EINS \033[$FG\033[$BG  $T  \033[0m";
        done
        echo;
    done
    echo
}

function reload() {
    if [ -n "$BASH_VERSION" ]; then
        # Reload bash settings
        if [ -f "$HOME/.bashrc" ]; then
            source "$HOME/.bashrc"
        fi
    elif [ -n "$ZSH_VERSION" ]; then
        # Reload zsh settings
        if [ -f "$ZDOTDIR/.zshrc" ]; then
            source "$ZDOTDIR/.zshrc"
        fi
    fi
}

################################################################################
# Auto Color
################################################################################

alias diff='diff --color=auto'
alias dir='dir --color=auto'
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'
alias grep='grep --color=auto'
alias ip='ip --color=auto'
alias ls='ls --color=auto'
alias vdir='vdir --color=auto'

################################################################################
# ls aliases
################################################################################

alias ll='ls -Alh --group-directories-first'
alias la='ls -A --group-directories-first'
command_exists tree && alias tree='tree --filesfirst -C'

# `ls` and `tree` alternative
# https://github.com/eza-community/eza
command_exists eza && alias eza='eza --color=always --group-directories-first'
command_exists eza && alias ls='eza'
command_exists eza && alias ll='eza -alh'
command_exists eza && alias la='eza -a'
command_exists eza && alias tree='eza -T --group-directories-last'

################################################################################
# Adding flags
################################################################################

alias mv='mv -iv'
alias rm='rm -i --preserve-root'
alias cp='cp -iv'
alias ln='ln -iv'
alias mkdir='mkdir -v'
alias rmdir='rmdir -v'
alias chgrp='chgrp -c --preserve-root'
alias chmod='chmod -c --preserve-root'
alias chown='chown -c --preserve-root'
alias diffs='diff --side-by-side'
alias df='df -hT'
alias du='du -ch'
alias free='free -m'
# alias mount='mount | column -t'

################################################################################
# Command shortcuts
################################################################################

alias c='clear'
alias h='history'
alias j='jobs -l'
alias q='exit'

# systemctl
alias poweroff='systemctl poweroff'
alias reboot='systemctl reboot'
alias shutdown='systemctl shutdown'

# ps
# alias psa="ps auxf"
# alias psgrep="ps aux | grep -v grep | grep -i -e VSZ -e"
# alias psmem='ps auxf | sort -nr -k 4'
# alias pscpu='ps auxf | sort -nr -k 3'

################################################################################
# Other
################################################################################

# count files in dur
alias count='find . -type f | wc -l'
# get error messages from journalctl
alias jctl="journalctl -p 3 -xb"

# ipinfo
alias myip='curl ipinfo.io/ip; echo'

# weather
alias weather='curl wttr.in/Warsaw; echo'

# Network aliases (TODO)
# alias n="netstat -np tcp"
# alias mtr="mtr -t"
# alias nmap="nmap -v -v -T5"
# alias nmapp="nmap -P0 -A --osscan_limit"
# alias pktstat="sudo pktstat -tBFT"

# `cat` alternative
command_exists batcat && alias bat='batcat'
# command_exists bat && alias cat='batcat'

# find alternative
command_exists fdfind && alias fd='fdfind'

################################################################################
# Dev
################################################################################

# Python
alias activate='source .venv/bin/activate'
alias newvenv='python -m venv .venv && source .venv/bin/activate && [ ! -f requirements.txt ] || pip install -r requirements.txt && [ ! -f pyproject.toml ] || pip install -e .'

# Quickly serve the current directory as HTTP
alias serve='xdg-open http://0.0.0.0:8000/ && ruby -run -e httpd . -p 8000'
alias servepy='xdg-open http://0.0.0.0:8000/ && python -m http.server'

################################################################################
# Git
################################################################################

alias g="git"
alias gco="git checkout"
alias gst="git status -sb"
alias gbr="git branch"
alias gci="git commit"
alias gaa="git add --all"
alias glg="git log --graph --pretty=format:'%C(auto)%h -%d %s, %C(blue)%cd%C(reset), %C(bold green)%an%C(reset)' --decorate --date=format:'%Y-%M-%d %H:%M:%S' --abbrev-commit"

alias gitweb="git instaweb -l --httpd=webrick"
alias gitwebs="git instaweb -l --httpd=webrick --stop"
